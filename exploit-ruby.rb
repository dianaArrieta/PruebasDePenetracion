#!/usr/bin/ruby

#ARRIETA JIMENEZ DIANA LAURA
#NOTA: me condundi al leer las instrucciones, lo hice para smtp
require 'socket'
if (ARGV.length < 2)
	puts "\t Uso: exploit-ruby.rb ip username"
	exit
end
host = ARGV[0]
usuario = ARGV[1]
begin
	s = TCPSocket.open(host,25)
	puts s.gets
	s.print("VRFY "+usuario+" \n")
	response = s.gets
	if (response =~ /252/)
		puts "user -> " + usuario + " : Existe"
	elsif (response =~ /550/)
		puts "user -> " + usuario + " : No existe"
	else
		puts "No se pudo verificar el usuario "+usuario	
	end
rescue SystemCallError
	puts "No se puede conectar el host: " +host
end
